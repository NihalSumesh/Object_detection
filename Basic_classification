""" Simple object detection program which is fed a single file as input and 
will return the object identified in the image.
It classifies the main object in the image and shows the probability of it
being any other object.
"""

import keras
from keras import backend as K
from keras.layers.core import Dense, Activation
from keras.optimizers import Adam
from keras.metrics import categorical_crossentropy
from keras.preprocessing.image import ImageDataGenerator
from keras.preprocessing import image
from keras.models import Model
from keras.applications import imagenet_utils
import numpy as np
from IPython.display import Image

#Initializes an instance of the mobilenet model
mobile = keras.applications.mobilenet.MobileNet()

#Function used to convert the file into a model readable format
def prepare_image(file):
    img_path = ''
    img = image.load_img(img_path + file, target_size=(224, 224))
    img_array = image.img_to_array(img)
    img_array_expanded_dims = np.expand_dims(img_array, axis=0)
    return keras.applications.mobilenet.preprocess_input(img_array_expanded_dims)

#Enter the file name you want to classify
preprocessed_image = prepare_image('catto.jpg')
predictions = mobile.predict(preprocessed_image)
results = imagenet_utils.decode_predictions(predictions)
#Displays the result of the classification 
results
